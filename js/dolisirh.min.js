"use strict";window.dolisirh||(window.dolisirh={},window.dolisirh.scriptsLoaded=!1),window.dolisirh.scriptsLoaded||(window.dolisirh.init=function(){window.dolisirh.load_list_script()},window.dolisirh.load_list_script=function(){if(!window.dolisirh.scriptsLoaded){let i=void 0,t=void 0;for(i in window.dolisirh)for(t in window.dolisirh[i].init&&window.dolisirh[i].init(),window.dolisirh[i])window.dolisirh[i]&&window.dolisirh[i][t]&&window.dolisirh[i][t].init&&window.dolisirh[i][t].init();window.dolisirh.scriptsLoaded=!0}},window.dolisirh.refresh=function(){let i=void 0,t=void 0;for(i in window.dolisirh)for(t in window.dolisirh[i].refresh&&window.dolisirh[i].refresh(),window.dolisirh[i])window.dolisirh[i]&&window.dolisirh[i][t]&&window.dolisirh[i][t].refresh&&window.dolisirh[i][t].refresh()},$(document).ready(window.dolisirh.init)),window.dolisirh.task={},window.dolisirh.task.init=function(){window.dolisirh.task.event()},window.dolisirh.task.event=function(){$(document).on("click",".auto-fill-timespent",window.dolisirh.task.addTimeSpent),$(document).on("click",".auto-fill-timespent-project",window.dolisirh.task.divideTimeSpent),$(document).on("click",".show-only-favorite-tasks",window.dolisirh.task.showOnlyFavoriteTasks),$(document).on("click",".show-only-tasks-with-timespent",window.dolisirh.task.showOnlyTasksWithTimeSpent),$(document).on("click",".timespent-create",window.dolisirh.task.createTimeSpent),$(document).on("click",".toggleTaskFavorite",window.dolisirh.task.toggleTaskFavorite),$(document).on("submit","#addtimeform",window.dolisirh.task.searchForm)},window.dolisirh.task.addTimeSpent=function(){var i=$(".non-consumed-time-minute").val(),t=$(".non-consumed-time-hour").val();$(".inputhour").val(""),$(".inputminute").val(""),$(this).closest(".duration").find(".inputhour").val(t),$(this).closest(".duration").find(".inputminute").val(i)},window.dolisirh.task.divideTimeSpent=function(){var i=$(this).closest(".project-line").attr("id");let t,n;var o=+$(".non-consumed-time-minute").val()+60*+$(".non-consumed-time-hour").val(),e=$("."+i).length;let s=parseInt(o/e);$(".inputhour").val(""),$(".inputminute").val(""),$("."+i).each(function(){n=parseInt(s/60),t=s%60,$(this).find(".inputhour").val(n),$(this).find(".inputminute").val(t)})},window.dolisirh.task.showOnlyFavoriteTasks=function(){var i=$(".id-container").find('input[name="token"]').val();let t="?";document.URL.match(/\?/)&&(t="&");let n;n=$(this).is(":checked")?1:0,$.ajax({url:document.URL+t+"action=show_only_favorite_tasks&token="+i,type:"POST",processData:!1,data:JSON.stringify({showOnlyFavoriteTasks:n}),contentType:!1,success:function(){window.location.reload()},error:function(){}})},window.dolisirh.task.showOnlyTasksWithTimeSpent=function(){var i=$(".id-container").find('input[name="token"]').val();let t="?";document.URL.match(/\?/)&&(t="&");let n;n=$(this).is(":checked")?1:0,$.ajax({url:document.URL+t+"action=show_only_tasks_with_timespent&token="+i,type:"POST",processData:!1,data:JSON.stringify({showOnlyTasksWithTimeSpent:n}),contentType:!1,success:function(){window.location.reload()},error:function(){}})},window.dolisirh.task.createTimeSpent=function(){var i=$(this).attr("value"),t=$(this).closest(".timespent-add-modal").find(".timespent-container"),n=t.find(".timespent-timestamp").val(),o=t.find(".timespent-datehour").val(),e=t.find(".timespent-datemin").val(),s=t.find(".timespent-comment").val(),a=t.find(".timespent-hour").val(),t=t.find(".timespent-min").val(),d=(window.saturne.loader.display($(this)),$(".fiche").find('input[name="token"]').val());let r="?";document.URL.match(/\?/)&&(r="&"),$.ajax({url:document.URL+r+"action=add_timespent&token="+d,data:JSON.stringify({taskID:i,timestamp:n,datehour:o,datemin:e,comment:s,hour:a,min:t}),type:"POST",processData:!1,contentType:!1,success:function(i){$(".loader-spin").remove(),$(".wpeo-loader").removeClass("wpeo-loader"),$("#timespent").removeClass("modal-active"),$("#tablelines3").html($(i).find("#tablelines3"))},error:function(i){}})},window.dolisirh.task.toggleTaskFavorite=function(){let t=$(this).attr("value");var i=$('form[name="addtime"]').find('input[name="token"]').val();let n="?";document.URL.match(/\?/)&&(n="&"),$.ajax({url:document.URL+n+"action=toggleTaskFavorite&taskId="+t+"&token="+i,type:"POST",processData:!1,contentType:!1,success:function(){var i=$("#"+t);i.hasClass("fas")?(i.removeClass("fas"),i.addClass("far")):i.hasClass("far")&&(i.removeClass("far"),i.addClass("fas"))},error:function(i){}})},window.saturne.modal.addMoreOpenModalData=function(i,t){var t=t.find(".timespent"),n=t.attr("data-task-id"),o=t.attr("data-timestamp"),e=t.attr("data-cell"),t=t.attr("data-date");$(".timespent-taskid").val(n),$(".timespent-timestamp").val(o),$(".timespent-cell").val(e),$(".timespent-create").attr("value",n),$(".timespent-date").html(t)},window.dolisirh.task.searchForm=function(i){i.preventDefault();var i=document.getElementById("addtimeform"),i=new FormData(i),t=new FormData;for(const n of i.entries())""!=n[1]&&t.append(n[0],n[1]);window.saturne.loader.display($("#addtimeform")),$.ajax({url:document.URL,type:"POST",data:t,processData:!1,contentType:!1,success:function(i){$(".wpeo-loader").removeClass("wpeo-loader"),$("#addtimeform").html($(i).find("#addtimeform").children())}})};